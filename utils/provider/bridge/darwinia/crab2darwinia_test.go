package darwinia

import (
	"github.com/ethereum/go-ethereum/common"
	"github.com/shopspring/decimal"
	"github.com/stretchr/testify/assert"
	"omni-balance/utils"
	"omni-balance/utils/chains"
	"testing"
)

func TestCrab2Darwinia(t *testing.T) {
	var (
		args   = InitVar(t)
		amount = decimal.NewFromBigInt(chains.EthToWei(decimal.RequireFromString("0")), 0)
	)
	tx, err := Crab2Darwinia(args.ctx, SwapParams{
		Sender:    args.sender,
		TokenName: "CRAB",
		Amount:    amount,
		Nonce:     1716966768607,
		Client:    args.client,
	})
	assert.NoError(t, err)
	utils.AssertEqualFold(t, common.Bytes2Hex(tx.Data), "7104aad5000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018fc331bfdf00000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000005463200000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000")
	assert.Equal(t, tx.To.Hex(), "0x004D0dE211BC148c3Ce696C51Cbc85BD421727E9")

	tx, err = Crab2Darwinia(args.ctx, SwapParams{
		Sender:    args.sender,
		TokenName: "RING",
		Amount:    amount,
		Nonce:     1716966714726,
		Client:    args.client,
	})
	assert.NoError(t, err)
	utils.AssertEqualFold(t, common.Bytes2Hex(tx.Data), "57bf0985000000000000000000000000273131f7cb50ac002bdd08ca721988731f7e1092000000000000000000000000a8d0e9a45249ec839c397fa0f371f5f64ecab7f700000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018fc330ed6600000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000001443ef13e84d9992d1461a1f90cac4653658cea4fd000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000552da00000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000")
	assert.Equal(t, tx.To.Hex(), "0xf6372ab2d35B32156A19F2d2F23FA6dDeFBE58bd")
}
