package darwinia

import (
	"github.com/ethereum/go-ethereum/common"
	"github.com/shopspring/decimal"
	"github.com/stretchr/testify/assert"
	"omni-balance/utils"
	"omni-balance/utils/chains"
	"testing"
)

func TestDarwinia2Crab(t *testing.T) {
	var (
		args   = InitVar(t)
		amount = decimal.NewFromBigInt(chains.EthToWei(decimal.RequireFromString("0")), 0)
	)
	tx, err := Darwinia2Crab(args.ctx, SwapParams{
		Sender:    args.sender,
		TokenName: "RING",
		Amount:    amount,
		Nonce:     1716966591656,
		Client:    args.client,
	})
	assert.NoError(t, err)
	utils.AssertEqualFold(t, common.Bytes2Hex(tx.Data), "7104aad5000000000000000000000000000000000000000000000000000000000000002c00000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018fc32f0ca800000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000003f4a600000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000")
	assert.Equal(t, tx.To.Hex(), "0xA8d0E9a45249Ec839C397fa0F371f5F64eCAB7F7")

	tx, err = Darwinia2Crab(args.ctx, SwapParams{
		Sender:    args.sender,
		TokenName: "CRAB",
		Amount:    amount,
		Nonce:     1716966643973,
		Client:    args.client,
	})
	assert.NoError(t, err)
	utils.AssertEqualFold(t, common.Bytes2Hex(tx.Data), "57bf0985000000000000000000000000656567eb75b765fc320783cc6edd86bd854b2305000000000000000000000000004d0de211bc148c3ce696c51cbc85bd421727e900000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018fc32fd90500000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000000000000000000000000000000000000001443ef13e84d9992d1461a1f90cac4653658cea4fd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000003f80f00000000000000000000000043ef13e84d9992d1461a1f90cac4653658cea4fd00000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000")
	assert.Equal(t, tx.To.Hex(), "0xf6372ab2d35B32156A19F2d2F23FA6dDeFBE58bd")
}
